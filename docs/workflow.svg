<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 520" font-family="Segoe UI, Arial, sans-serif">

  <!-- Background -->
  <rect width="900" height="520" rx="12" fill="#0d1117"/>

  <!-- Title -->
  <text x="450" y="42" text-anchor="middle" font-size="20" font-weight="bold" fill="#e6edf3">HIBP Binary Creator â€” Workflow</text>
  <line x1="60" y1="55" x2="840" y2="55" stroke="#30363d" stroke-width="1"/>

  <!-- â”€â”€ PrepareEnv box â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <rect x="30" y="72" width="200" height="370" rx="8" fill="#161b22" stroke="#30363d" stroke-width="1.5"/>
  <rect x="30" y="72" width="200" height="36" rx="8" fill="#1f6feb"/>
  <rect x="30" y="96" width="200" height="12" rx="0" fill="#1f6feb"/>
  <text x="130" y="96" text-anchor="middle" font-size="13" font-weight="bold" fill="#ffffff">PrepareEnv.ps1</text>

  <!-- PrepareEnv steps -->
  <g fill="#8b949e" font-size="12">
    <circle cx="52" cy="132" r="10" fill="#21262d" stroke="#30363d" stroke-width="1"/>
    <text x="52" y="136" text-anchor="middle" fill="#58a6ff" font-size="11" font-weight="bold">1</text>
    <text x="70" y="136" fill="#c9d1d9">Create folder structure</text>

    <circle cx="52" cy="167" r="10" fill="#21262d" stroke="#30363d" stroke-width="1"/>
    <text x="52" y="171" text-anchor="middle" fill="#58a6ff" font-size="11" font-weight="bold">2</text>
    <text x="70" y="168" fill="#c9d1d9">.NET SDK â‰¥ v8</text>
    <text x="70" y="182" fill="#6e7681">(winget install)</text>

    <circle cx="52" cy="207" r="10" fill="#21262d" stroke="#30363d" stroke-width="1"/>
    <text x="52" y="211" text-anchor="middle" fill="#58a6ff" font-size="11" font-weight="bold">3</text>
    <text x="70" y="208" fill="#c9d1d9">haveibeenpwned-</text>
    <text x="70" y="222" fill="#c9d1d9">downloader</text>
    <text x="70" y="236" fill="#6e7681">(dotnet tool)</text>

    <circle cx="52" cy="261" r="10" fill="#21262d" stroke="#30363d" stroke-width="1"/>
    <text x="52" y="265" text-anchor="middle" fill="#58a6ff" font-size="11" font-weight="bold">4</text>
    <text x="70" y="262" fill="#c9d1d9">PsiRepacker.exe</text>
    <text x="70" y="276" fill="#6e7681">(git clone)</text>
  </g>

  <!-- config.psd1 output -->
  <rect x="50" y="310" width="160" height="36" rx="6" fill="#0d419d" stroke="#1f6feb" stroke-width="1"/>
  <text x="130" y="327" text-anchor="middle" font-size="11" fill="#79c0ff">ğŸ“„ config.psd1</text>
  <text x="130" y="340" text-anchor="middle" font-size="10" fill="#6e7681">paths + tool locations</text>

  <!-- idempotent badge -->
  <rect x="50" y="362" width="160" height="26" rx="13" fill="#1a2a1a" stroke="#238636" stroke-width="1"/>
  <text x="130" y="379" text-anchor="middle" font-size="11" fill="#3fb950">âœ“ idempotent â€” safe to re-run</text>

  <!-- Log output -->
  <rect x="50" y="400" width="160" height="26" rx="6" fill="#161b22" stroke="#30363d" stroke-width="1"/>
  <text x="130" y="417" text-anchor="middle" font-size="11" fill="#6e7681">ğŸ“‹ logs\PrepareEnv_*.log</text>

  <!-- â”€â”€ Arrow: PrepareEnv â†’ BinaryCreator â”€â”€â”€ -->
  <line x1="230" y1="260" x2="270" y2="260" stroke="#30363d" stroke-width="1.5" stroke-dasharray="5,3"/>
  <polygon points="267,255 277,260 267,265" fill="#30363d"/>

  <!-- â”€â”€ BinaryCreator box â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <rect x="278" y="72" width="590" height="370" rx="8" fill="#161b22" stroke="#30363d" stroke-width="1.5"/>
  <rect x="278" y="72" width="590" height="36" rx="8" fill="#388bfd" opacity="0.25"/>
  <rect x="278" y="96" width="590" height="12" rx="0" fill="#388bfd" opacity="0.25"/>
  <text x="573" y="96" text-anchor="middle" font-size="13" font-weight="bold" fill="#ffffff">BinaryCreator.ps1</text>

  <!-- Step 1: Disk check -->
  <rect x="298" y="116" width="170" height="56" rx="6" fill="#21262d" stroke="#30363d" stroke-width="1"/>
  <text x="298" y="112" font-size="10" fill="#58a6ff" font-weight="bold">STEP 1 â€” PRE-FLIGHT</text>
  <text x="383" y="138" text-anchor="middle" font-size="12" fill="#c9d1d9">ğŸ’¾ Disk space check</text>
  <text x="383" y="155" text-anchor="middle" font-size="11" fill="#6e7681">â‰¥ 100 GB free required</text>
  <text x="383" y="168" text-anchor="middle" font-size="11" fill="#6e7681">Tools validated</text>

  <!-- Arrow down -->
  <line x1="383" y1="172" x2="383" y2="194" stroke="#388bfd" stroke-width="1.5"/>
  <polygon points="378,191 383,201 388,191" fill="#388bfd"/>

  <!-- Step 2: Download -->
  <rect x="298" y="204" width="170" height="72" rx="6" fill="#0d2d4d" stroke="#388bfd" stroke-width="1.5"/>
  <text x="298" y="200" font-size="10" fill="#58a6ff" font-weight="bold">STEP 2 â€” DOWNLOAD</text>
  <text x="383" y="228" text-anchor="middle" font-size="12" fill="#c9d1d9">ğŸŒ HIBP API</text>
  <text x="383" y="244" text-anchor="middle" font-size="11" fill="#6e7681">1,048,576 hash ranges</text>
  <text x="383" y="258" text-anchor="middle" font-size="11" fill="#6e7681">64 parallel threads</text>
  <text x="383" y="272" text-anchor="middle" font-size="11" fill="#3fb950">~25 min  |  ~69 GB</text>

  <!-- File: pwnedpasswords_ntlm.txt -->
  <rect x="298" y="294" width="170" height="42" rx="6" fill="#1a1a2e" stroke="#58a6ff" stroke-width="1"/>
  <text x="383" y="313" text-anchor="middle" font-size="11" fill="#79c0ff">ğŸ“„ pwnedpasswords_ntlm.txt</text>
  <text x="383" y="328" text-anchor="middle" font-size="10" fill="#6e7681">~69 GB  â€¢  NTLM hashes</text>

  <!-- Arrow down to compress -->
  <line x1="383" y1="336" x2="383" y2="356" stroke="#388bfd" stroke-width="1.5"/>
  <polygon points="378,353 383,363 388,353" fill="#388bfd"/>

  <!-- Step 3: Compress -->
  <rect x="298" y="366" width="170" height="56" rx="6" fill="#0d2d4d" stroke="#388bfd" stroke-width="1.5"/>
  <text x="298" y="362" font-size="10" fill="#58a6ff" font-weight="bold">STEP 3 â€” PACK</text>
  <text x="383" y="388" text-anchor="middle" font-size="12" fill="#c9d1d9">ğŸ”§ PsiRepacker.exe</text>
  <text x="383" y="403" text-anchor="middle" font-size="11" fill="#6e7681">load â†’ sort â†’ save</text>
  <text x="383" y="416" text-anchor="middle" font-size="11" fill="#3fb950">~8 min  |  ~55% reduction</text>

  <!-- Arrow to verify -->
  <line x1="468" y1="395" x2="510" y2="395" stroke="#388bfd" stroke-width="1.5"/>
  <polygon points="507,390 517,395 507,400" fill="#388bfd"/>

  <!-- Step 4: Verify + Cleanup -->
  <rect x="518" y="116" width="320" height="130" rx="6" fill="#21262d" stroke="#30363d" stroke-width="1"/>
  <text x="518" y="112" font-size="10" fill="#58a6ff" font-weight="bold">STEP 4 â€” VERIFY &amp; CLEANUP</text>

  <!-- Binary output -->
  <rect x="534" y="124" width="288" height="44" rx="6" fill="#1a2a1a" stroke="#238636" stroke-width="1.5"/>
  <text x="678" y="144" text-anchor="middle" font-size="13" font-weight="bold" fill="#3fb950">ğŸ“¦ hibpntlmhashes</text>
  <text x="678" y="159" text-anchor="middle" font-size="11" fill="#3fb950">ddMMyy.bin  (~31 GB)</text>

  <text x="534" y="192" font-size="11" fill="#c9d1d9">âœ“ Sanity check  (â‰¥10% of source)</text>
  <text x="534" y="208" font-size="11" fill="#c9d1d9">ğŸ—‘  Delete source .txt  (free ~69 GB)</text>
  <text x="534" y="224" font-size="11" fill="#6e7681">   (skip with -KeepHashFile)</text>

  <!-- Divider -->
  <line x1="534" y1="232" x2="826" y2="232" stroke="#30363d" stroke-width="1"/>

  <!-- Log -->
  <rect x="534" y="240" width="130" height="26" rx="6" fill="#161b22" stroke="#30363d" stroke-width="1"/>
  <text x="599" y="257" text-anchor="middle" font-size="11" fill="#6e7681">ğŸ“‹ BinaryCreator_*.log</text>

  <!-- Summary -->
  <rect x="676" y="240" width="146" height="26" rx="6" fill="#161b22" stroke="#30363d" stroke-width="1"/>
  <text x="749" y="257" text-anchor="middle" font-size="11" fill="#6e7681">ğŸ“Š Summary output</text>

  <!-- Connect compress to verify -->
  <line x1="517" y1="395" x2="517" y2="148" stroke="#388bfd" stroke-width="1.5"/>
  <polygon points="512,151 517,141 522,151" fill="#388bfd"/>

  <!-- downstream use -->
  <rect x="518" y="300" width="320" height="80" rx="6" fill="#161b22" stroke="#30363d" stroke-width="1"/>
  <text x="678" y="320" text-anchor="middle" font-size="11" fill="#6e7681">Downstream use</text>
  <rect x="534" y="328" width="134" height="38" rx="6" fill="#21262d" stroke="#30363d" stroke-width="1"/>
  <text x="601" y="345" text-anchor="middle" font-size="11" fill="#c9d1d9">ğŸ” Get-BadPasswords</text>
  <text x="601" y="359" text-anchor="middle" font-size="10" fill="#6e7681">improsec/Get-BadPasswords</text>
  <rect x="682" y="328" width="140" height="38" rx="6" fill="#21262d" stroke="#30363d" stroke-width="1"/>
  <text x="752" y="345" text-anchor="middle" font-size="11" fill="#c9d1d9">ğŸ”’ AD Password Audit</text>
  <text x="752" y="359" text-anchor="middle" font-size="10" fill="#6e7681">offline, no API needed</text>

  <!-- Arrow: binary â†’ downstream -->
  <line x1="678" y1="168" x2="678" y2="296" stroke="#3fb950" stroke-width="1.5" stroke-dasharray="4,3"/>
  <polygon points="673,293 678,303 683,293" fill="#3fb950"/>

  <!-- â”€â”€ Footer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <line x1="60" y1="458" x2="840" y2="458" stroke="#30363d" stroke-width="1"/>
  <text x="450" y="480" text-anchor="middle" font-size="11" fill="#6e7681">Data source: </text>
  <text x="540" y="480" text-anchor="middle" font-size="11" fill="#58a6ff">haveibeenpwned.com</text>
  <text x="625" y="480" text-anchor="middle" font-size="11" fill="#6e7681"> â€” Troy Hunt</text>

  <text x="450" y="500" text-anchor="middle" font-size="11" fill="#6e7681">Tools: </text>
  <text x="500" y="500" text-anchor="middle" font-size="11" fill="#58a6ff">HaveIBeenPwned/PwnedPasswordsDownloader</text>
  <text x="688" y="500" text-anchor="middle" font-size="11" fill="#6e7681"> + </text>
  <text x="730" y="500" text-anchor="middle" font-size="11" fill="#58a6ff">improsec/PsiRepacker</text>

</svg>
